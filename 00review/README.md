# 规划综述

## 背景介绍

随着智能运输系统的应用，减少了部分乏味的驾驶任务，使得驾驶员的压力得到了有效的缓解。尤其是在高速场景，CC、ACC以及CACC相继发展，通过预定义与前车保持的车距进行纵向执行器的控制，如油门和制动踏板，驾驶任务也越来越安全；对于城市场景，主动悬架辅助紧急制动、自动泊车或车辆盲角检测等系统也有助于在人口稠密地区实现更安全的驾驶。

这些系统也提高了安全性、舒适性，降低了通行时间和能源消耗，被称为是辅助自动驾驶（ADAS）。完全自动驾驶能力是当前部分自动驾驶的拓展，意味着车辆能够脱离人的干预而自主驾驶。实际上，最近关于自动驾驶的演示都面临着复杂的真实场景。谷歌（在不同环境中的自动驾驶超过70万小时）、戴姆勒和卡尔斯鲁厄理工学院（KIT），以自动驾驶的方式重现了历史上第一次汽车越野之旅；Vislab和帕尔马大学，在2013年的 PROUD 项目演示中展示了自动驾驶能力。这些最近的演示表明了在自动驾驶技术方面取得了喜人的成果，即便如此，完全自动驾驶的目标仍然很远，在技术和法律层面上均还有很多未能克服的挑战。

政府和制造商之间发起的一些举措目前正在为自动驾驶的新标准和法规创建框架。事实上，一些正在欧洲进实施的措施旨在解决法律问题并促进这些技术的标准化，如 Citymobil2 项目。他们获得了地方当局的车辆演示许可，并制定了一些认证程序。在美国，已经有四个州（内华达州、佛罗里达州、加利福尼亚州和密歇根州）和哥伦比亚特区意识到了这些技术对未来可持续交通的重要性，并制定了具体法律以允许在普通交通中自动驾驶。

在技术层面上，自动驾驶软件架构百花齐放。斯坦佛和卡耐基梅隆大学在 DARPA 挑战赛上首次展示了完全自动驾驶技术。在欧洲，VIAC 工程和戴姆勒KIT定义了完全自动驾驶车辆软件架构所需要的不同处理阶段，其中主要包括感知、决策和控制。

<img src="picture/control architecture for automated vehicle.png" style="zoom:80%;" />

## 运动规划算法

运动规划方法分成四大类：分别为图搜索、采样，差值和数值优化

<table>
  	<tr>
		<td>算法组</td>
		<td>技术</td>
        <td>技术描述</td>
        <td>实现</td>
	<tr>
	<tr>
		<td rowspan="8">图搜索</td>
        <td rowspan="2">Dijkstra</td>
        <td>带联合权重的已知节点或单元的搜索</td>
        <td>[27, 51~53]</td>
    </tr>
	<tr>
		<td>根据环境计算节点或单元的权重</td>
        <td>[26, 28]</td>
	</tr>
	<tr>
		<td rowspan="4">A*</td>
		<td>Voronoi代价函数的Anytime D*</td>
        <td>[10, 16, 30]</td>
	</tr>
	<tr>
		<td>Hybrid-Heuristics A*</td>
        <td>[36, 54]</td>
	</tr>
    <tr>
        <td>Voronoi状态晶格的环境地图的A*</td>
        <td>[35, 37， 51]</td>
    </tr>
    <tr>
        <td>PAO*</td>
        <td>[55, 56]</td>
    </tr>
    <tr>
        <td rowspan="2">状态晶格（lattice）</td>
        <td>环境分解为局部变网格，主要是操作的复杂程度</td>
        <td>[16, 30, 46, 57]</td>
    </tr>
    <tr>
        <td>时空状态晶格</td>
        <td>[39, 47, 50, 58~60]</td>
    </tr>
    <tr>
		<td rowspan="3">采样法</td>
        <td rowspan="3">RRT</td>
        <td>物理和逻辑的偏值用以生成随机树</td>
        <td>[61~63]</td>
    </tr>
    <tr>
        <td>实时RRT*</td>
        <td>[40, 53, 64, 65]</td>
    </tr>
    <tr>
        <td>RRT轨迹协调</td>
        <td>[66]</td>
    </tr>
    <tr>
		<td rowspan="9">插值法</td>
        <td>直线段和圆弧段</td>
        <td>已知点的道路拟合和插值</td>
        <td>[41，67]</td>
    </tr>
    <tr>
		<td rowspan="2">回旋曲线</td>
        <td>直线、回旋曲线、圆弧生成的轨迹片段</td>
        <td>[42，68~72]</td>
    </tr>
    <tr>
        <td>离线确定的回旋曲线参数应用在在线规划</td>
        <td>[14，73, 74]</td>
    </tr>
    <tr>
		<td rowspan="2">多项式曲线</td>
        <td>三阶多项式曲线</td>
        <td>[50, 75]</td>
    </tr>
    <tr>
        <td>高阶多项式曲线</td>
        <td>[76~80]</td>
    </tr>
    <tr>
		<td rowspan="2">贝塞尔曲线</td>
        <td>选取最佳控制点</td>
        <td>[44, 79, 81~84]</td>
    </tr>
    <tr>
        <td>非严格实现</td>
        <td>[85, 86]</td>
    </tr>
    <tr>
		<td rowspan="2">样条曲线</td>
        <td>多项式片段实现</td>
        <td>[15, 28, 76]</td>
    </tr>
    <tr>
        <td>基本样条曲线（B-样条）</td>
        <td>[87~89]</td>
    </tr>
    <tr>
		<td>数值优化</td>
		<td>优化函数</td>
        <td>优化速度、加速度、转向等等参数</td>
        <td>[5, 38, 54, 90~92]</td>
	<tr>
</table>



特点分析维度说明：

- 实时性，反应算法的时间复杂度，最直接的就是cpu时间，自动驾驶软件总框架会限定规划模块的处理时间，比如100ms，那么我们的算法在此时间内能够处理完毕，则成为满足实时性要求；
- 完备性，是指如果在起始点和目标点间有路径解存在，那么一定可以得到解，如果得不到解那么一定说明没有解存在；
- 概率完备性，是指如果在起始点和目标点间有路径解存在，只要规划或搜索的时间足够长，就一定能确保找到一条路径解；
- 最优性，是指规划得到的路径在某个评价指标上是最优的；
- 渐进最优性，是指经过有限次规划迭代后得到的路径是接近最优的次优路径，且每次迭代后都与最优路径更加接近，是一个逐渐收敛的过程；
- 路径连续性，多指几何连续，即路径的多个片段的起始点相连，而且切向量的方向相同
- 曲率连续，从数学角度，曲率由一阶导和二阶导计算得出，曲率连续说明二阶导存在且连续，即二阶连续；从汽车理论角度，曲率等价于转向角，曲率连续代表方向盘做旋转运动顺滑

| 技术           | 优点                                                     | 缺陷                                     |
| -------------- | -------------------------------------------------------- | ---------------------------------------- |
| Dijkstra       | 适于结构化和非结构化环境下找到最短路径，完备、最优       | 不满足实时性要求，结果不连续，计算量大   |
| A*系列         | 启发式搜索降低计算时间，完备、最优                       | 结果不连续，启发规则不容易直接获得       |
| 状态晶格       | 处理多维能力强，适于动态环境和局部规划                   | 计算非常耗时，仅在结果完备性             |
| RRT系列        | 高维系统下快速求解，求解收敛且完备（概率完备、渐进最优） | 结果不连续                               |
| 插值曲线       | 适用于结构化环境下有安全性、舒适性要求场合               | 结果取决于路点，有障碍物的情况下计算耗时 |
| 直线段和圆弧段 | 低计算量，实现简单，能保证路径最短                       | 曲率不连续，片段连接不舒适，依赖于路点   |
| 回旋曲线       | 适用于局部规划，高速和结构化道路容易实现                 | 积分导致耗时，曲率连续但不平顺，依赖路点 |
| 多项式曲线     | 低计算量，曲率连续                                       | 曲率连续需要四阶以上，关键参数不易获得   |
| 贝塞尔曲线     | 低计算量，曲率连续                                       | 增加曲线阶数时低延展性，计算量增大       |
| 样条曲线       | 低计算量，曲率连续                                       | 结果可能非优                             |
| 优化函数       | 容易考虑各种约束                                         | 计算量大，耗时，严重依赖于路点           |

